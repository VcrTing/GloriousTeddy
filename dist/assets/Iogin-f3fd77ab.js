import{_ as L}from"./OBtnSave.vue_vue_type_script_setup_true_lang-d2b48ed1.js";import{d as v,g as f,a8 as $,h as p,o as k,c as b,a as o,b as l,w as _,i as c,B as d,C as g,ag as u,q as I,aK as T,aL as B,m as x,L as y,u as C,n as R,k as h,ac as U,p as V}from"./index-b4afc0b7.js";import{L as j}from"./IOGO_MENU-fa97cfbe.js";import{_ as O}from"./OInputI.vue_vue_type_script_setup_true_lang-3f2bd017.js";import{c as S}from"./verify-18da9a0d.js";import{b as w}from"./route-block-83d24a4e.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-9b15bf0f.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-0e0658b3.js";import"./MBtn.vue_vue_type_script_setup_true_lang-44e75704.js";import"./Oi.vue_vue_type_script_setup_true_lang-6a37493a.js";import"./DocumentTextIcon-833e7eb5.js";import"./XMarkIcon-7de3378c.js";const A={class:"py"},E=o("div",{class:"py"},null,-1),N=v({__name:"ioginForm",props:{form:{},aii:{}},setup(i){const s=i,n=["name","pass"],t=f($(s.form));return p(()=>s.aii.sign,()=>{n.map(a=>{if(u(t,a,s.form[a],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),p(()=>s.form.name,a=>u(t,"name",a,s.aii)),p(()=>s.form.pass,a=>u(t,"pass",a,s.aii,()=>!S(a,200))),(a,e)=>{const r=O;return k(),b("div",null,[o("div",A,[l(r,{icon:"email",err:c(t).name},{default:_(()=>[d(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=m=>a.form.name=m),placeholder:"登錄郵箱"},null,512),[[g,a.form.name]])]),_:1},8,["err"]),E,l(r,{icon:"lock",err:c(t).pass},{default:_(()=>[d(o("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=m=>a.form.pass=m),placeholder:"登錄密碼"},null,512),[[g,a.form.pass]])]),_:1},8,["err"])])])}}}),P={"":"網絡連結錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！"},q=async(i,s)=>I(P,()=>T.post(B+"/auth/local",{identifier:i,password:s})),D=async i=>{if(i&&!x(i)){let s={};switch(i=i,i.status){case 301:break;default:s=i.data;break}s.jwt&&y().iogin(s.jwt,s.user)}return i},F={class:"px-x3 w-100"},G={class:"fx-c"},H={class:"w-28"},K=["src"],M=o("h3",{class:"pb-x2 pt-x1 us-n"},"登錄",-1),z=o("div",{class:"py"},null,-1),J={class:"pt ani-scaie"},Q=v({__name:"Iogin",setup(i){const s=C(),n=f({ioading:!1,msg:"",can:!1,sign:0}),t=f({name:"",pass:""}),a={submit:()=>h(async()=>{if(!n.ioading){n.ioading=!0;const e=U(t),r=await D(await q(e.name,e.pass));x(r)?V(r,n):await a.success(),setTimeout(()=>n.ioading=!1,200)}}),init:()=>h(()=>{{const e=localStorage.getItem("handshake_auth_name");e&&(t.name=e)}}),success:async()=>{localStorage.setItem("handshake_auth_name",t.name),await y().userinfo()&&s.push("/"),setTimeout(()=>n.ioading=!1,100)}};return R(a.init),(e,r)=>{const m=L;return k(),b("div",F,[o("div",G,[o("div",H,[o("img",{class:"w-100 ani-scaie-hv us-n br-s",src:c(j)},null,8,K)])]),M,l(N,{aii:c(n),form:c(t)},null,8,["aii","form"]),z,o("div",J,[l(m,{class:"w-100 ani-scaie-aii",aii:c(n),tit:"登錄",onClick:r[0]||(r[0]=W=>a.submit())},null,8,["aii"])])])}}});typeof w=="function"&&w(Q);export{Q as default};
