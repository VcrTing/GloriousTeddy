import{_ as C}from"./OBtnSave.vue_vue_type_script_setup_true_lang-e1463eeb.js";import{d as w,g as f,a8 as L,h as l,o as b,c as x,a as t,b as p,w as d,i as c,B as _,C as h,ag as u,q as T,aK as $,aL as U,m as k,L as y,u as B,n as I,k as g,ac as N,p as O,N as R,aM as V}from"./index-337f7f81.js";import{L as j}from"./IOGO_MENU-fa97cfbe.js";import{_ as A}from"./OInputI.vue_vue_type_script_setup_true_lang-81fc1593.js";import{c as S}from"./verify-18da9a0d.js";import{b as v}from"./route-block-83d24a4e.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-88fa6bb8.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-97bf9dac.js";import"./MBtn.vue_vue_type_script_setup_true_lang-0750471d.js";import"./Oi.vue_vue_type_script_setup_true_lang-1b79ed73.js";import"./DocumentTextIcon-4065dfc9.js";import"./XMarkIcon-68aaf1a8.js";const E={class:"py"},M=t("div",{class:"py"},null,-1),P=w({__name:"ioginForm",props:{form:{},aii:{}},setup(i){const s=i,o=["name","pass"],e=f(L(s.form));return l(()=>s.aii.sign,()=>{o.map(a=>{if(u(e,a,s.form[a],s.aii)){s.aii.can=!1;return}}),s.aii.can=!0}),l(()=>s.form.name,a=>u(e,"name",a,s.aii)),l(()=>s.form.pass,a=>u(e,"pass",a,s.aii,()=>!S(a,200))),(a,n)=>{const r=A;return b(),x("div",null,[t("div",E,[p(r,{icon:"email",err:c(e).name},{default:d(()=>[_(t("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=m=>a.form.name=m),placeholder:"登錄郵箱"},null,512),[[h,a.form.name]])]),_:1},8,["err"]),M,p(r,{icon:"lock",err:c(e).pass},{default:d(()=>[_(t("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=m=>a.form.pass=m),placeholder:"登錄密碼"},null,512),[[h,a.form.pass]])]),_:1},8,["err"])])])}}}),q={"":"網絡連結錯誤！！！","Invalid identifier or password":"帳戶或密碼錯誤！！！"},D=async(i,s)=>T(q,()=>$.post(U+"/auth/local",{identifier:i,password:s})),F=async i=>{if(i&&!k(i)){let s={};switch(i=i,i.status){case 301:break;default:s=i.data;break}s.jwt&&y().iogin(s.jwt,s.user)}return i},G={class:"px-x3 w-100"},H={class:"fx-c"},K={class:"w-24"},z=["src"],J=t("h3",{class:"pb-x2 pt-x1 us-n"},"登錄",-1),Q=t("div",{class:"py-x1 us-n"},[t("p",{class:"ttd hand tit-hv ts ani-scaie-hv d-ib"},"註冊")],-1),W={class:"pt ani-scaie"},X=w({__name:"Iogin",setup(i){const s=B(),o=f({ioading:!1,msg:"",can:!1,sign:0}),e=f({name:"",pass:""}),a={submit:()=>g(async()=>{if(!o.ioading){o.ioading=!0;const n=N(e),r=await F(await D(n.name,n.pass));k(r)?O(r,o):await a.success(),setTimeout(()=>o.ioading=!1,200)}}),init:()=>g(()=>{R(V,e)}),success:async()=>{localStorage.setItem("handshake_auth_name",e.name),await y().userinfo()&&s.push("/"),setTimeout(()=>o.ioading=!1,100)}};return I(a.init),(n,r)=>{const m=C;return b(),x("div",G,[t("div",H,[t("div",K,[t("img",{class:"w-100 ani-scaie-hv us-n br-s",src:c(j)},null,8,z)])]),J,p(P,{aii:c(o),form:c(e)},null,8,["aii","form"]),Q,t("div",W,[p(m,{class:"w-100 ani-scaie-aii",aii:c(o),tit:"登錄",onClick:r[0]||(r[0]=Y=>a.submit())},null,8,["aii"])])])}}});typeof v=="function"&&v(X);export{X as default};
